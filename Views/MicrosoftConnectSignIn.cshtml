﻿@using Orchard.ContentManagement;

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:wl="http://apis.live.net/js/2010">

@{
    Script.Require("Jquery");
    Script.Include("http://js.live.net/4.1/loader.js");    
    var settings = WorkContext.CurrentSite.As<NGM.OpenAuthentication.Models.OpenAuthenticationSettingsPart>().Record; }

<script type="text/javascript">
    function signOutCallback() {
        var data = {
            __RequestVerificationToken: "@Html.AntiForgeryTokenValueOrchard()"
        };

        $.post("/Users/Account/LogOff", data, function() {
                location.reload();
            });
    }
</script>

<wl:signin onsignout="{signOutCallback}" ></wl:signin>

<wl:app 
    channel-url="../../Modules/NGM.OpenAuthentication/Pages/channel.htm" 
    callback-url="@NGM.OpenAuthentication.Core.OAuth.LiveIdParametersHelpers.LiveIdCallback()"
    client-id=@settings.LiveIdClientIdentifier
    scope="@Model.Permissions">
</wl:app>